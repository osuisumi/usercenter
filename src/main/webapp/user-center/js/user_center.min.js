///<jscompress sourcefile="common.js" />
///<jscompress sourcefile="photoAlbum.js" />
//相片预览
$(document).ready(function(){commonJs.fn.init();$("input,textarea").placeholder();$(".m-selectbox select").simulateSelectBox();$(".m-radio-tick input").bindCheckboxRadioSimulate();$(".m-checkbox-tick input").bindCheckboxRadioSimulate()});var commonJs=$(window).commonJs||{};commonJs.fn={init:function(){this.toTop();this.searchAnimate()},aJumpLayer:function(a){a=$(a);var b=a.innerWidth(),c=a.innerHeight();a.show().css({"margin-top":-c/2+"px","margin-left":-b/2+"px"});$(".m-blackbg").show();a.find(".u-confirm-btn").bind("click",function(){a.hide();$(".m-blackbg").hide()});a.find(".u-cancel-btn").bind("click",function(){a.hide();$(".m-blackbg").hide()});a.find(".u-close-btn").bind("click",function(){a.hide();$(".m-blackbg").hide()})},openABlayer:function(a){a=$(a);var b=$(".m-blackbg"),c=$(window).scrollTop();a.show().css("top",c+100+"px");b.show();this.closeABlayer(a,b)},closeABlayer:function(a,b){var c=a.find(".u-close-btn"),d=a.find(".u-cancel-btn"),e=a.find(".u-confirm-btn");c.on("click",function(){a.hide();b.hide()});d.on("click",function(){a.hide();b.hide()});e.on("click",function(){a.hide();b.hide()})},toTop:function(){$(document).on("click","#toTop",function(){$("html,body").animate({scrollTop:0},100);return!1})},searchAnimate:function(){function a(){$(".m-srh .ipt").on("focus",function(){var a=$(this),b=a.next();""==a.val()&&(a.stop().animate({width:"146px","padding-left":"12px"},500),b.stop().animate({right:"10px"},500))});$(".m-srh .ipt").on("blur",function(){var a=$(this),b=a.next();""==a.val()&&(a.stop().animate({width:"60px","padding-left":"98px"},500),b.stop().animate({right:"100px"},500))})}function b(){$(".m-srh .ipt").on("blur",function(){var a=$(this).parent();""==$(this).val()?a.removeClass("hasValue"):a.addClass("hasValue")})}"Microsoft Internet Explorer"==navigator.appName?a():b()},guideHint:function(a,b){var c=!1;""!=b&&"undefined"!=b&&null!=b&&void 0!=b&&(c=!0);$("body").append(a);$(".g-guide-hint .confirm").on("click",function(){$(this).parents(".g-guide-hint").remove();$(".m-guideShade").remove();c&&b()})}};$.fn.extend({myTab:function(a){a=$.extend({pars:".myTab",tabNav:".tabNav",li:"li",tabCon:".tabCon",tabList:".tabList",cur:"cur",eType:"click",page:0},a);var b=$(this),c=b.find(a.tabNav).find(a.li);tabList=b.find(a.tabCon).find(a.tabList);this.each(function(){c.removeClass(a.cur);c.eq(a.page).addClass(a.cur);tabList.hide();tabList.eq(a.page).show();c.eq(a.page).show();c.on(a.eType,function(){var c=$(this).parents(a.tabNav).find(a.li).index(this);$(this).addClass(a.cur).siblings().removeClass(a.cur);$(this).parents(a.pars).find(a.tabCon).find(a.tabList).eq(c).css({display:"block"}).siblings().css({display:"none"})})});return this}});(function(a){a.fn.simulateSelectBox=function(b){b=a.extend(!0,{selectText:".simulateSelect-text",byValue:null},b);var c=b.selectText,d=b.byValue;return this.each(function(){var b=a(this);b.find("option").prop("selected",!1);if(""==d||null==d||void 0==d)b.find("option").eq(0).prop("selected",!0);else for(var f=0;f<b.find("option").length;f++)b.find("option").eq(f).val()==d&&b.find("option").eq(f).prop("selected",!0);b.parent().find(c).text(b.find('option[selected\x3d"selected"]').text());b.parent().find(c).text(b.find("option:selected").text())}).on("change",function(){a(this).parent().find(c).text(a(this).find("option:selected").text())})}})(jQuery);(function(a){a.fn.bindCheckboxRadioSimulate=function(b){function c(b){var c;void 0!=b.attr("type")&&(c=b.attr("type"),"checkbox"==c?b.prop("checked")?d.checkbox_checked_fn(b):d.checkbox_nochecked_fn(b):"radio"==c&&void 0!=b.attr("name")&&(c=b.attr("name"),b.prop("checked")?(d.radio_checked_fn(b),a("input[name\x3d'"+c+"']").not(b).each(function(){d.radio_nochecked_fn(a(this))})):d.radio_nochecked_fn(b)))}var d={className:"on",onclick:null,checkbox_checked_fn:function(a){a.parent().addClass(this.className)},checkbox_nochecked_fn:function(a){a.parent().removeClass(this.className)},radio_checked_fn:function(a){a.parent().addClass(this.className)},radio_nochecked_fn:function(a){a.parent().removeClass(this.className)}};a.extend(!0,d,b);return this.each(function(){c(a(this))}).click(function(){c(a(this));if(d.onclick)d.onclick(this,{isChecked:a(this).prop("checked"),objThis:a(this)})})}})(jQuery);(function(a,b,c){function d(a){var b={},d=/^jQuery\d+$/;c.each(a.attributes,function(a,c){c.specified&&!d.test(c.name)&&(b[c.name]=c.value)});return b}function e(a,d){var e=c(this);if(this.value==e.attr("placeholder")&&e.hasClass("placeholder"))if(e.data("placeholder-password")){e=e.hide().next().show().attr("id",e.removeAttr("id").data("placeholder-id"));if(!0===a)return e[0].value=d;e.focus()}else this.value="",e.removeClass("placeholder"),this==b.activeElement&&this.select()}function f(){var a,b=c(this),f=this.id;if(""==this.value){if("password"==this.type){if(!b.data("placeholder-textinput")){try{a=b.clone().attr({type:"text"})}catch(g){a=c("\x3cinput\x3e").attr(c.extend(d(this),{type:"text"}))}a.removeAttr("name").data({"placeholder-password":!0,"placeholder-id":f}).bind("focus.placeholder",e);b.data({"placeholder-textinput":a,"placeholder-id":f}).before(a)}b=b.removeAttr("id").hide().prev().attr("id",f).show()}b.addClass("placeholder");b[0].value=b.attr("placeholder")}else b.removeClass("placeholder")}var h="placeholder"in b.createElement("input"),k="placeholder"in b.createElement("textarea"),g=c.fn,l=c.valHooks;h&&k?(g=g.placeholder=function(){return this},g.input=g.textarea=!0):(g=g.placeholder=function(){this.filter((h?"textarea":":input")+"[placeholder]").not(".placeholder").bind({"focus.placeholder":e,"blur.placeholder":f}).data("placeholder-enabled",!0).trigger("blur.placeholder");return this},g.input=h,g.textarea=k,g={get:function(a){var b=c(a);return b.data("placeholder-enabled")&&b.hasClass("placeholder")?"":a.value},set:function(a,d){var g=c(a);if(!g.data("placeholder-enabled"))return a.value=d;""==d?(a.value=d,a!=b.activeElement&&f.call(a)):g.hasClass("placeholder")?e.call(a,!0,d)||(a.value=d):a.value=d;return g}},h||(l.input=g),k||(l.textarea=g),c(function(){c(b).delegate("form","submit.placeholder",function(){var a=c(".placeholder",this).each(e);setTimeout(function(){a.each(f)},10)})}),c(a).bind("beforeunload.placeholder",function(){c(".placeholder").each(function(){this.value=""})}))})(this,document,jQuery);String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};String.prototype.equalsIgnoreCase=function(a){return this.toLowerCase()==a.toLowerCase()};$.extend({ajaxQuery:function(a,b,c,d){if(null==d||""==d)d="get";$.ajax({url:$("#"+a).attr("action"),data:$("#"+a).serialize(),type:d,success:function(a){$("#"+b).html(a);void 0!=c&&(a=c,$.isFunction(a)||(a=eval("("+c+")")),a())}})},ajaxSubmit:function(a){var b=$("#"+a).serialize(),c=$("#"+a).attr("method");if("delete"==c||"DELETE"==c||"put"==c||"PUT"==c)b="_method\x3d"+c+"\x26"+b;return $.ajax({url:$("#"+a).attr("action"),data:b,type:"post",async:!1,success:function(a){}}).responseText},ajaxDelete:function(a,b,c){$.ajax({url:a,type:"post",data:"_method\x3dDELETE\x26"+b,success:function(a){if(void 0!=c){var b=c;$.isFunction(b)||(b=eval("("+c+")"));b(a)}}})},put:function(a,b,c){$.ajax({url:a,type:"post",data:"_method\x3dPUT\x26"+b,success:function(a){if(void 0!=c){var b=c;$.isFunction(b)||(b=eval("("+c+")"));b(a)}}})}});function assignParam(a,b){$.each($("#"+a+" :input"),function(){$(this).val($("#"+$(this).attr("id")+"_"+b).text())})}function checkAllBox(a,b){$(b).click(function(){$(this).prop("checked")?$("#"+a+" :checkbox").each(function(){$(this).prop("checked",!0)}):$("#"+a+" :checkbox").each(function(){$(this).prop("checked",!1)})})}function initLimit(a,b,c,d){a.keyup(function(){var e=a.val(),f=0;if(c){for(var h=0;h<e.length;h++)255<e.charCodeAt(h)?f+=2:f++;e=Math.floor((b-f)/2)}else f=e.length,e=b-f;d(e)})}function guid(){return(G()+G()+""+G()+""+G()+""+G()+""+G()+G()+G()).toUpperCase()}function G(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function hintJumpLayer(){$(".m-blackbg").show();var a=$(".g-layer-warning"),b=a.innerWidth(),c=a.innerHeight();a.show().css({"margin-top":-c/2+"px","margin-left":-b/2+"px"})}window.alert=function(a,b,c){if(null==c||""==c)c=1500;mylayerFn.msg(a,{time:c},b)};window.confirm=function(a,b,c){mylayerFn.confirm({content:a,icon:3,yesFn:b,cancelFn:c})};function getByteLength(a){for(var b=a.trim().length,c=0;c<a.length;c++)127<a.charCodeAt(c)&&(b+=2);return b}function getSuffix(a){var b=a.lastIndexOf(".");return a.substring(b+1,a.length)}function getOuterHtml(a){for(var b=$("\x3cdiv\x3e\x3c/div\x3e"),c=0;c<a.length;c++)b.append($(a[c]).clone());return b.html()}function isMatchJson(a){return a.match("^{(.+:.+,*){1,}}$")?!0:!1}function closeLayer(){var a=parent.layer.getFrameIndex(window.name);parent.layer.close(a)}function downloadFile(a,b,c,d){$('#downloadFileForm input[name\x3d"id"]').val(a);$('#downloadFileForm input[name\x3d"fileName"]').val(b);$('#downloadFileForm input[name\x3d"fileRelations[0].type"]').val(c);$('#downloadFileForm input[name\x3d"fileRelations[0].relation.id"]').val(d);$("#downloadFileForm").submit()}function updateFile(a,b){$('#updateFileForm input[name\x3d"id"]').val(a);$('#updateFileForm input[name\x3d"fileName"]').val(b);$.post("/file/updateFileInfo.do",$("#updateFileForm").serialize())}function deleteFileRelation(a,b,c){$('#deleteFileRelationForm input[name\x3d"fileId"]').val(a);$('#deleteFileRelationForm input[name\x3d"relation.id"]').val(b);$('#deleteFileRelationForm input[name\x3d"type"]').val(c);$.post("/file/deleteFileRelation.do",$("#deleteFileRelationForm").serialize())}function deleteFileInfo(a){$('#deleteFileInfoForm input[name\x3d"id"]').val(a);$.post("/file/deleteFileInfo.do",$("#deleteFileInfoForm").serialize())}function createCourseIndex(){window.location.href="/make/course?orders\x3dCREATE_TIME.DESC"}function goChangePassword(){mylayerFn.open({type:2,title:"\u4fee\u6539\u5bc6\u7801",fix:!1,area:[620,480],content:"/ncts/account/edit_password"})}function previewFile(a){mylayerFn.open({type:2,title:"\u9884\u89c8\u6587\u4ef6",fix:!0,area:[99*$(window).width()/100,99*$(window).height()/100],content:"/file/previewFile?fileId\x3d"+a,shadeClose:!0})}var photoPreview=$(window).photoPreview||{},photoPreview={p_index:0,f_index:0,element:{p_wrap:"#photoPreviewBd",layer:".g-photoPreview-layer",big_list:".m-preview-bList",small_list:".m-preview-sList"},photo_area_height:null,total:0,page:1,limit:9,totalPage:0,nowPhotoId:"",init:function(a,b,c,d){""!==a&&void 0!==a&&"undefined"!==a&&null!==a&&(this.p_index=a);this.total=b||0;this.page=c||1;this.limit=d||9;this.totalPage=Math.ceil(this.total/this.limit);this.show();this.close()},show:function(){var a=$(this.element.p_wrap);a.show();this.photo_area_height=parseInt($(this.element.layer).height()-140);a.find(this.element.big_list).css("height",this.photo_area_height+"px");this.bigPhoto(a);this.smallPhoto(a)},close:function(){$(this.element.p_wrap).on("click",".close",function(){$(photoPreview.element.p_wrap).hide()})},bigPhoto:function(a){var b=a.find(this.element.big_list).children().length;photoPreview.photoChange(a);photoPreview.hidePrevNextBtn();$("#photoPreiewPrev").off().on("click",function(){$("#photoPreiewNext").show();0===photoPreview.p_index&&prev();photoPreview.p_index--;photoPreview.hidePrevNextBtn();photoPreview.photoChange(a)});$("#photoPreiewNext").off().on("click",function(){$("#photoPreiewPrev").show();photoPreview.p_index===b-1&&next();photoPreview.p_index++;photoPreview.hidePrevNextBtn();photoPreview.photoChange(a)})},smallPhoto:function(a){var b=$(photoPreview.element.layer).find(photoPreview.element.small_list),c=b.children(),d=$("#photoPreiewFocusPrev"),e=$("#photoPreiewFocusNext");c.innerWidth();parseInt(c.css("marginRight"));b.parent().width();photoPreview.f_index=parseInt(photoPreview.p_index/photoPreview.limit);photoPreview.totalPage>photoPreview.page?e.show():e.hide();1<photoPreview.page?d.show():d.hide();c.on("click",function(){photoPreview.p_index=a.find(photoPreview.element.small_list).children().index(this);photoPreview.photoChange(a);photoPreview.hidePrevNextBtn()})},photoChange:function(a){var b=a.find(photoPreview.element.big_list).children(),c=b.eq(photoPreview.p_index).children("img").attr("photoId");photoPreview.nowPhotoId=c;loadPhotoDetail(c);c=b.eq(photoPreview.p_index).children("img").height();b.removeClass("z-crt").eq(photoPreview.p_index).addClass("z-crt");b.eq(photoPreview.p_index).children("img").css("top",(photoPreview.photo_area_height-c)/2+"px");a.find(photoPreview.element.small_list).children().removeClass("z-crt").eq(photoPreview.p_index).addClass("z-crt")},hidePrevNextBtn:function(){1==photoPreview.page&&0>=photoPreview.p_index?$("#photoPreiewPrev").hide():$("#photoPreiewPrev").show();photoPreview.page==photoPreview.totalPage&&photoPreview.p_index+1>=photoPreview.total%photoPreview.limit?$("#photoPreiewNext").hide():$("#photoPreiewNext").show()}};